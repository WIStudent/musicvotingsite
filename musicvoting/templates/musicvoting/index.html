{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="{% static 'musicvoting/style-bootstrap.css' %}">
		<link rel="stylesheet" type="text/css" href="{% static 'musicvoting/bootstrap-3.3.2-dist/css/bootstrap.min.css' %}">
		<script src="{% static 'musicvoting/jquery_2.1.3/jquery-2.1.3.min.js' %}" type="text/javascript"></script>
		<script src="{% static 'musicvoting/bootstrap-3.3.2-dist/js/bootstrap.min.js' %}" type="text/javascript"></script>
		<script src="{% static 'musicvoting/scripts.js' %}" type="text/javascript"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<title>Musicvoting</title>
	</head>
	<body>

  

		<div id="index_content" class="container">
			<header>
				<nav id="navbar" class="navbar navbar-default">
					<div class="container-fluid">
						<!-- Brand and toggle get grouped for better mobile display -->
						<div class="navbar-header">
							<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1">
								<span class="sr-only">Toggle navigation</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</button>
							<a class="navbar-brand" href="#">Musicvoting</a>
						</div>
						
						<!-- Collect the nav links, forms, and other content for toggling -->
						<div class="collapse navbar-collapse" id="navbar-collapse-1">
							<ul class="nav navbar-nav">
								<li><a href="/artist/">Artists</a></li>
								<li><a href="/album/">Albums</a></li>
							</ul>
							<!-- Search-->					
							<form class="navbar-form navbar-left" role="search" action="{% url 'musicvoting:search' %}" method="GET">
								<div class="input-group">
									<input type="text" class="form-control" placeholder="Search" name="search">
									<div class="input-group-btn">
										<button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
									</div>
								</div>
							</form><!-- /Search -->
							<ul class="nav navbar-nav navbar-right">
							
								<!-- Shutdown -->
								{% if user.is_superuser %}
								<li><a href="#" data-toggle="modal" data-target="#modal-shutdown">Shut down</a><li>
								
								<!-- Modal -->
								<div class="modal fade" id="modal-shutdown" tabindex="-1" role="dialog" aria-labelledby="modal-shutdown-label" aria-hidden="true">
									<div class="modal-dialog">
										<div class="modal-content">
											<div class="modal-header">
												<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
												<h4 class="modal-title" id="modal-shutdown-label">Are you sure that you want to shut down the device?</h4>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
												<button type="button" class="btn btn-primary" onClick="shutdown()" >Shut down</button>
											</div>
										</div>
									</div>
								</div>
								<!-- /Modal -->
								{% endif %}
								<!-- /Shutdown -->
								
								{% if user.is_authenticated %}
								<li><a href="/logout?next=/">Logout</a></li>
								{% else %}
								<li><a href="/login?next=/">Login</a></li>
								{% endif %}
							</ul>
						</div><!-- /.navbar-collapse -->
					</div>
				</nav>
				
				<ol class="breadcrumb">
					<li class="active">Home</li>
				</ol>
			</header>
			
			{% if not cookie %}
			<div id="cookie_warning">
				This website uses cookies. Please enable cookies in your browser and refresh the page.
			</div>
			<script type="text/javascript">
				<!--
				var test_cookie = getCookie("test_cookie");
				if (test_cookie == "true"){
					document.getElementById("cookie_warning").style.display = 'none';
					document.cookie = "test_cookie=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";
				}
				//-->
			</script>
			{% endif %} 

			{% if player_running %}
			
			{% include "musicvoting/player.html" %}
		
			{% if admin %}
			<div class="btn-group btn-group-justified" data-loading-text="Loading...">
				{% if playing %}
				<a class="btn btn-primary" id="pause_play_button" data-loading-text="Loading..." data-pause-text="Pause" data-unpause-text="Unpause" onClick="pause()">Pause</a>
				{% else %}
				<a class="btn btn-primary" id="pause_play_button" data-loading-text="Loading..." data-pause-text="Pause" data-unpause-text="Unpause" onClick="unpause()">Unpause</a>
				{% endif %}
				<a class="btn btn-primary" id="next_button" data-loading-text="Loading..." onClick="next()">Next</a>
			</div>
			{% endif %}<!-- if admin -->
			
			{% else %}
			<div class="alert alert-danger">Alert: Player is not running!</div>
			{% endif %}<!-- if player_running -->
		
			<h3>Top most voted tracks</h3>
			{% if track_ranking %}
			<ul class="list-group">
				{% for track in track_ranking %}
				<li class="list-group-item track-item">
					<div class="track_vote">					
						<div>
							{% if voter in track.voting_users.all %}
							<button id="vote_unvote_button-{{ track.id }}" type="button" data-loading-text="Loading..." data-vote-text="Vote" data-unvote-text="Unvote" class="btn btn-primary" onClick="unvote({{ track.id }})">Unvote</button>
							{% else %}
							<button id="vote_unvote_button-{{ track.id }}" type="button" data-loading-text="Loading..." data-vote-text="Vote" data-unvote-text="Unvote" class="btn btn-primary" onClick="vote({{ track.id }})">Vote</button>
							{% endif %}
						</div>
						<div id="votes-{{ track.id }}" class="votes">
							Votes: {{ track.votes }}
						</div>
					</div>
					<div class="track_info">
						<div>{{ track.title }}</div>
						<div>Artist: <a href="{% url 'musicvoting:artist_detail' track.artist.id %}">{{ track.artist.artist_name }}</a></div>
						<div>Album: <a href="{% url 'musicvoting:album_detail' track.album.id %}">{{ track.album.album_name }}</a></div>
					</div>
				</li>
				{% endfor %}
			<ul>
			{% else %}
			<p>No track was voted. DJ Shuffle decides which track will be played next.</p>
			{% endif %}
		</div>

	</body>
</html>